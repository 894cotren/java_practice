# PhoneNumbers Excel 导入导出功能

## 功能概述

本模块提供了基于EasyExcel的电话号码数据导入导出功能，支持大量数据的批量处理。

## 主要功能

### 1. 数据导出
- **接口**: `GET /excel/export`
- **参数**: `count` (可选，默认100条)
- **功能**: 生成指定数量的测试数据并导出为Excel文件
- **示例**: `http://localhost:8080/excel/export?count=1000`

### 2. 数据导入
- **接口**: `POST /excel/import`
- **参数**: `file` (MultipartFile)
- **功能**: 导入Excel文件中的电话号码数据
- **支持格式**: .xlsx, .xls

### 3. 导入模板下载
- **接口**: `GET /excel/template`
- **功能**: 下载标准的导入模板文件
- **包含**: 示例数据和字段说明

### 4. 测试数据生成
- **接口**: `GET /excel/generate`
- **参数**: `count` (可选，默认100条)
- **功能**: 生成测试数据（JSON格式，不下载文件）

## 数据字段说明

| 字段名 | 类型 | 必填 | 说明 | 示例 |
|--------|------|------|------|------|
| 姓名 | String | 是 | 用户姓名 | 张三 |
| 电话号码 | String | 是 | 11位手机号 | 13800138000 |
| 状态 | String | 是 | 手机状态 | 正常/停机/欠费/注销/暂停 |
| 邮箱 | String | 否 | 邮箱地址 | zhangsan@example.com |
| 城市 | String | 否 | 所在城市 | 北京 |
| 创建时间 | Date | 否 | 创建时间 | 2024-01-01 10:00:00 |

## 数据验证规则

### 电话号码验证
- 必须为11位数字
- 必须以1开头
- 第二位数字为3-9

### 邮箱验证
- 符合标准邮箱格式
- 可选字段，可为空

### 必填字段
- 姓名、电话号码、状态为必填字段
- 其他字段为可选

## 使用流程

### 1. 下载导入模板
```bash
curl -X GET "http://localhost:8080/excel/template" -o 导入模板.xlsx
```

### 2. 填写数据
按照模板格式填写数据，注意：
- 必填字段不能为空
- 电话号码格式要正确
- 邮箱格式要正确（如果填写）

### 3. 导入数据
```bash
curl -X POST "http://localhost:8080/excel/import" \
  -F "file=@数据文件.xlsx"
```

### 4. 导出数据
```bash
# 导出100条测试数据
curl -X GET "http://localhost:8080/excel/export" -o 导出数据.xlsx

# 导出1000条测试数据
curl -X GET "http://localhost:8080/excel/export?count=1000" -o 导出数据.xlsx
```

## 技术特性

### 批量处理
- 支持大量数据导入（百万级）
- 批量插入，提高性能
- 内存优化，避免OOM

### 数据验证
- 实时数据验证
- 详细的错误提示
- 支持数据清理

### 错误处理
- 详细的错误日志
- 行号定位错误
- 批量错误收集

## 注意事项

1. **文件大小限制**: 建议单次导入不超过10万条数据
2. **内存使用**: 大量数据导入时会占用较多内存
3. **数据格式**: 严格按照模板格式填写数据
4. **网络超时**: 大量数据导出可能需要较长时间

## 扩展功能

### 自定义数据生成
可以通过修改 `ExcelServiceImpl.generateTestData()` 方法来自定义测试数据的生成规则。

### 数据验证扩展
可以通过修改 `PhoneNumbersImportDTO.validate()` 方法来添加更多的数据验证规则。

### 批量处理优化
可以通过修改 `ExcelReadListener.INSERT_BATCH_SIZE` 来调整批量处理的大小。
